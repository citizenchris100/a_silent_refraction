Godot Engine v3.5.2.stable.official.170ba337a - https://godotengine.org
OpenGL ES 2.0 Renderer: Mesa Intel(R) Graphics (ADL GT2)
 
[DEBUG SINGLETON] Initialized - Press backtick (`) key for console
CoordinateManager initialized
ScrollingCamera._ready() called - Script Path: res://src/core/camera/scrolling_camera.gd
ScrollingCamera class loaded - Script ID: 1314
[TRACE] Camera initialized with screen size: (1424, 952)
Debug drawing is disabled
No target player set
Setting up camera state test...
Creating a new ScrollingCamera instance
ScrollingCamera._ready() called - Script Path: res://src/core/camera/scrolling_camera.gd
ScrollingCamera class loaded - Script ID: 1322
[TRACE] Camera initialized with screen size: (1424, 952)
Debug drawing is disabled
No target player set
Camera created successfully: @TestCamera@2
Setting target_player to: MockPlayer:[Node2D:1324]
[CAMERA DEBUG] Camera state changed from IDLE to FOLLOWING_PLAYER
Created mock player at: (500, 500)
Configuring camera for testing...
ScrollingCamera._ready() called - Script Path: res://src/core/camera/scrolling_camera.gd
ScrollingCamera class loaded - Script ID: 1325
[TRACE] Camera initialized with screen size: (1424, 952)
Debug drawing is disabled
No target player set
Setting debug_draw to: True
[OVERLAY DEBUG] Created debug overlay
Setting test_mode to: True
Initializing TestBoundsValidator for test mode
TestBoundsValidator initialized - bounds validation disabled for testing
BoundsValidator initialized: Reference
Test mode enabled: True
Camera configured with position: (500, 500)
Camera bounds set to: (200, 200, 800, 800)
[CAMERA DEBUG] CoordinateManager singleton not available for registration
[CAMERA DEBUG] CoordinateManager singleton not available for registration
[CAMERA DEBUG] CoordinateManager singleton not available for registration
Camera found player: MockPlayer
Using default camera bounds based on screen size
Initializing DefaultBoundsValidator with bounds: (0, 0, 1424, 952)
BoundsValidator initialized: Reference

===== CAMERA INITIAL POSITION SETUP =====
Current camera position: (0, 0)
Initial position setting: (0, 0)
Initial view setting: right
Screen size: (1424, 952)

===== CALCULATING OPTIMAL ZOOM =====
Could not find background information - camera zoom unchanged
===== ZOOM CALCULATION COMPLETE =====

Camera half size (screen size / 2 / zoom): (712, 476)
Camera bounds: (0, 0, 1424, 952)
Background wide enough for scrolling: False
Background width: 1424, Min width for scrolling: 2136
Using RIGHT initial view setting
Centering camera on walkable area: (712, 476)
Setting camera position to: (712, 476)
Camera position after setting: (712, 476)
[CAMERA DEBUG] Checking camera position against walkable area center
Camera positioned for initial view: right at (712, 476)
View ratio: 100% of background is visible (1424 pixels of 1424 pixels)
===== CAMERA INITIAL POSITION SETUP COMPLETE =====

[CAMERA DEBUG] Camera state changed from IDLE to FOLLOWING_PLAYER
[CAMERA DEBUG] Camera initialized in FOLLOWING_PLAYER state
ERROR: Resumed function '_ready()' after yield, but class instance is gone. At script: res://src/core/camera/scrolling_camera.gd:434
   at: resume (modules/gdscript/gdscript_function.cpp:1802)
Camera found player: MockPlayer
Using default camera bounds based on screen size
Initializing TestBoundsValidator for test mode
TestBoundsValidator initialized - bounds validation disabled for testing
BoundsValidator initialized: Reference

===== CAMERA INITIAL POSITION SETUP =====
Current camera position: (500, 500)
Initial position setting: (0, 0)
Initial view setting: right
Screen size: (1024, 768)

===== CALCULATING OPTIMAL ZOOM =====
Could not find background information - camera zoom unchanged
===== ZOOM CALCULATION COMPLETE =====

Camera half size (screen size / 2 / zoom): (512, 384)
Camera bounds: (0, 0, 1024, 768)
Background wide enough for scrolling: False
Background width: 1024, Min width for scrolling: 1536
Using RIGHT initial view setting
Centering camera on walkable area: (512, 384)
Setting camera position to: (512, 384)
Camera position after setting: (512, 384)
[CAMERA DEBUG] Checking camera position against walkable area center
Camera positioned for initial view: right at (512, 384)
View ratio: 100% of background is visible (1024 pixels of 1024 pixels)
===== CAMERA INITIAL POSITION SETUP COMPLETE =====

Signal received: camera_state_changed - 2
[CAMERA DEBUG] Camera state changed from IDLE to FOLLOWING_PLAYER
[CAMERA DEBUG] Camera initialized in FOLLOWING_PLAYER state
Starting camera state tests...
===== TEST SUITE: State Transitions =====
Running test: Idle to Moving Transition
Signal received: camera_move_completed - (512, 384)
Signal received: camera_state_changed - 0
[CAMERA DEBUG] Camera state changed from FOLLOWING_PLAYER to IDLE
Signal received: camera_move_started - (700, 500)
Signal received: camera_state_changed - 1
[CAMERA DEBUG] Camera state changed from IDLE to MOVING
Signal received: camera_move_completed - (512, 384)
Signal received: camera_state_changed - 0
[CAMERA DEBUG] Camera state changed from MOVING to IDLE
✓ PASS: Idle to Moving Transition: Camera should transition from IDLE to MOVING and emit signal
Running test: Moving to Idle Transition
Signal received: camera_move_started - (700, 500)
Signal received: camera_state_changed - 1
[CAMERA DEBUG] Camera state changed from IDLE to MOVING
Signal received: camera_move_completed - (512, 384)
Signal received: camera_state_changed - 0
[CAMERA DEBUG] Camera state changed from MOVING to IDLE
✓ PASS: Moving to Idle Transition: Camera should transition from MOVING to IDLE and emit signal
Signal received: camera_state_changed - 2
[CAMERA DEBUG] Camera state changed from IDLE to FOLLOWING_PLAYER
Running test: Idle to Following Transition
Signal received: camera_move_completed - (512, 384)
Signal received: camera_state_changed - 0
[CAMERA DEBUG] Camera state changed from FOLLOWING_PLAYER to IDLE
Signal received: camera_state_changed - 2
[CAMERA DEBUG] Camera state changed from IDLE to FOLLOWING_PLAYER
Signal received: camera_move_completed - (512, 384)
Signal received: camera_state_changed - 0
[CAMERA DEBUG] Camera state changed from FOLLOWING_PLAYER to IDLE
✓ PASS: Idle to Following Transition: Camera should transition from IDLE to FOLLOWING_PLAYER and emit signal
Signal received: camera_state_changed - 2
[CAMERA DEBUG] Camera state changed from IDLE to FOLLOWING_PLAYER
Running test: Following to Idle Transition
Signal received: camera_move_completed - (512, 384)
Signal received: camera_state_changed - 0
[CAMERA DEBUG] Camera state changed from FOLLOWING_PLAYER to IDLE
✓ PASS: Following to Idle Transition: Camera should transition from FOLLOWING_PLAYER to IDLE and emit signal
Signal received: camera_state_changed - 2
[CAMERA DEBUG] Camera state changed from IDLE to FOLLOWING_PLAYER
Suite completed: 1/1 tests passed
===== TEST SUITE: State Properties =====
Running test: Idle State Properties
Signal received: camera_move_completed - (512, 384)
Signal received: camera_state_changed - 0
[CAMERA DEBUG] Camera state changed from FOLLOWING_PLAYER to IDLE
✓ PASS: Idle State Properties: IDLE state should have correct properties
Signal received: camera_state_changed - 2
[CAMERA DEBUG] Camera state changed from IDLE to FOLLOWING_PLAYER
Running test: Moving State Properties
Signal received: camera_move_started - (700, 500)
Signal received: camera_state_changed - 1
[CAMERA DEBUG] Camera state changed from FOLLOWING_PLAYER to MOVING
Signal received: camera_move_completed - (512, 384)
Signal received: camera_state_changed - 0
[CAMERA DEBUG] Camera state changed from MOVING to IDLE
✓ PASS: Moving State Properties: MOVING state should have correct properties
Signal received: camera_state_changed - 2
[CAMERA DEBUG] Camera state changed from IDLE to FOLLOWING_PLAYER
Running test: Following State Properties
Signal received: camera_move_completed - (512, 384)
Signal received: camera_state_changed - 0
[CAMERA DEBUG] Camera state changed from FOLLOWING_PLAYER to IDLE
✓ PASS: Following State Properties: FOLLOWING_PLAYER state should have correct properties
Signal received: camera_state_changed - 2
[CAMERA DEBUG] Camera state changed from IDLE to FOLLOWING_PLAYER
Suite completed: 2/2 tests passed
===== TEST SUITE: Player Following =====
Running test: Camera Follows Player
ensure_valid_target called with position: (700, 421)
Current test_mode value: True
[TEST] Bypassing all bounds validation due to test_mode=true for: (700, 421)
[CAMERA DEBUG] Camera following player: (700, 700) -> (536.53894, 388.829468)
ensure_valid_target called with position: (700, 421)
Current test_mode value: True
[TEST] Bypassing all bounds validation due to test_mode=true for: (700, 421)
[CAMERA DEBUG] Camera following player: (700, 700) -> (557.874878, 393.028564)
ensure_valid_target called with position: (700, 421)
Current test_mode value: True
[TEST] Bypassing all bounds validation due to test_mode=true for: (700, 421)
[CAMERA DEBUG] Camera following player: (700, 700) -> (576.425903, 396.679565)
ensure_valid_target called with position: (700, 421)
Current test_mode value: True
[TEST] Bypassing all bounds validation due to test_mode=true for: (700, 421)
[CAMERA DEBUG] Camera following player: (700, 700) -> (592.555542, 399.854034)
ensure_valid_target called with position: (700, 421)
Current test_mode value: True
[TEST] Bypassing all bounds validation due to test_mode=true for: (700, 421)
[CAMERA DEBUG] Camera following player: (700, 700) -> (606.579834, 402.614136)
ensure_valid_target called with position: (700, 421)
Current test_mode value: True
[TEST] Bypassing all bounds validation due to test_mode=true for: (700, 421)
[CAMERA DEBUG] Camera following player: (700, 700) -> (618.773621, 405.013977)
ensure_valid_target called with position: (700, 421)
Current test_mode value: True
[TEST] Bypassing all bounds validation due to test_mode=true for: (700, 421)
[CAMERA DEBUG] Camera following player: (700, 700) -> (629.375793, 407.100586)
ensure_valid_target called with position: (700, 421)
Current test_mode value: True
[TEST] Bypassing all bounds validation due to test_mode=true for: (700, 421)
[CAMERA DEBUG] Camera following player: (700, 700) -> (638.594116, 408.914825)
ensure_valid_target called with position: (700, 421)
Current test_mode value: True
[TEST] Bypassing all bounds validation due to test_mode=true for: (700, 421)
[CAMERA DEBUG] Camera following player: (700, 700) -> (646.609192, 410.492249)
ensure_valid_target called with position: (700, 421)
Current test_mode value: True
[TEST] Bypassing all bounds validation due to test_mode=true for: (700, 421)
[CAMERA DEBUG] Camera following player: (700, 700) -> (653.578064, 411.8638)
ensure_valid_target called with position: (700, 421)
Current test_mode value: True
[TEST] Bypassing all bounds validation due to test_mode=true for: (700, 421)
[CAMERA DEBUG] Camera following player: (700, 700) -> (659.637329, 413.056305)
ensure_valid_target called with position: (700, 421)
Current test_mode value: True
[TEST] Bypassing all bounds validation due to test_mode=true for: (700, 421)
[CAMERA DEBUG] Camera following player: (700, 700) -> (664.905701, 414.09317)
ensure_valid_target called with position: (700, 421)
Current test_mode value: True
[TEST] Bypassing all bounds validation due to test_mode=true for: (700, 421)
[CAMERA DEBUG] Camera following player: (700, 700) -> (669.48645, 414.99469)
ensure_valid_target called with position: (700, 421)
Current test_mode value: True
[TEST] Bypassing all bounds validation due to test_mode=true for: (700, 421)
[CAMERA DEBUG] Camera following player: (700, 700) -> (673.469238, 415.778534)
ensure_valid_target called with position: (700, 421)
Current test_mode value: True
[TEST] Bypassing all bounds validation due to test_mode=true for: (700, 421)
[CAMERA DEBUG] Camera following player: (700, 700) -> (676.93219, 416.460083)
Signal received: camera_move_completed - (676.93219, 416.460083)
Signal received: camera_state_changed - 0
[CAMERA DEBUG] Camera state changed from FOLLOWING_PLAYER to IDLE
✓ PASS: Camera Follows Player: Camera should move toward player when in FOLLOWING_PLAYER state
Running test: Toggle Follow Player
Signal received: camera_state_changed - 2
[CAMERA DEBUG] Camera state changed from IDLE to FOLLOWING_PLAYER
ensure_valid_target called with position: (700, 421)
Current test_mode value: True
[TEST] Bypassing all bounds validation due to test_mode=true for: (700, 421)
[CAMERA DEBUG] Camera following player: (700, 700) -> (536.53894, 388.829468)
ensure_valid_target called with position: (700, 421)
Current test_mode value: True
[TEST] Bypassing all bounds validation due to test_mode=true for: (700, 421)
[CAMERA DEBUG] Camera following player: (700, 700) -> (557.874878, 393.028564)
ensure_valid_target called with position: (700, 421)
Current test_mode value: True
[TEST] Bypassing all bounds validation due to test_mode=true for: (700, 421)
[CAMERA DEBUG] Camera following player: (700, 700) -> (576.425903, 396.679565)
ensure_valid_target called with position: (700, 421)
Current test_mode value: True
[TEST] Bypassing all bounds validation due to test_mode=true for: (700, 421)
[CAMERA DEBUG] Camera following player: (700, 700) -> (592.555542, 399.854034)
ensure_valid_target called with position: (700, 421)
Current test_mode value: True
[TEST] Bypassing all bounds validation due to test_mode=true for: (700, 421)
[CAMERA DEBUG] Camera following player: (700, 700) -> (606.579834, 402.614136)
ensure_valid_target called with position: (700, 421)
Current test_mode value: True
[TEST] Bypassing all bounds validation due to test_mode=true for: (700, 421)
[CAMERA DEBUG] Camera following player: (700, 700) -> (618.773621, 405.013977)
ensure_valid_target called with position: (700, 421)
Current test_mode value: True
[TEST] Bypassing all bounds validation due to test_mode=true for: (700, 421)
[CAMERA DEBUG] Camera following player: (700, 700) -> (629.375793, 407.100586)
ensure_valid_target called with position: (700, 421)
Current test_mode value: True
[TEST] Bypassing all bounds validation due to test_mode=true for: (700, 421)
[CAMERA DEBUG] Camera following player: (700, 700) -> (638.594116, 408.914825)
ensure_valid_target called with position: (700, 421)
Current test_mode value: True
[TEST] Bypassing all bounds validation due to test_mode=true for: (700, 421)
[CAMERA DEBUG] Camera following player: (700, 700) -> (646.609192, 410.492249)
ensure_valid_target called with position: (700, 421)
Current test_mode value: True
[TEST] Bypassing all bounds validation due to test_mode=true for: (700, 421)
[CAMERA DEBUG] Camera following player: (700, 700) -> (653.578064, 411.8638)
ensure_valid_target called with position: (700, 421)
Current test_mode value: True
[TEST] Bypassing all bounds validation due to test_mode=true for: (700, 421)
[CAMERA DEBUG] Camera following player: (700, 700) -> (659.637329, 413.056305)
ensure_valid_target called with position: (700, 421)
Current test_mode value: True
[TEST] Bypassing all bounds validation due to test_mode=true for: (700, 421)
[CAMERA DEBUG] Camera following player: (700, 700) -> (664.905701, 414.09317)
ensure_valid_target called with position: (700, 421)
Current test_mode value: True
[TEST] Bypassing all bounds validation due to test_mode=true for: (700, 421)
[CAMERA DEBUG] Camera following player: (700, 700) -> (669.48645, 414.99469)
Signal received: camera_move_completed - (669.48645, 414.99469)
Signal received: camera_state_changed - 0
[CAMERA DEBUG] Camera state changed from FOLLOWING_PLAYER to IDLE
✓ PASS: Toggle Follow Player: Camera should stop following player when follow_player is disabled
Suite completed: 1/1 tests passed
Signal received: camera_state_changed - 2
[CAMERA DEBUG] Camera state changed from IDLE to FOLLOWING_PLAYER
===== TEST SUITE: Movement Transitions =====
Running test: Immediate Movement
ensure_valid_target called with position: (700, 500)
Current test_mode value: True
[TEST] Bypassing all bounds validation due to test_mode=true for: (700, 500)
move_to_position called with pos=(700, 500), immediate=True
Target position after validation: (700, 500)
Immediate move from (512, 384) to (700, 500)
Signal received: camera_move_started - (700, 500)
Signal received: camera_move_completed - (700, 500)
Signal received: camera_move_completed - (700, 500)
Signal received: camera_state_changed - 0
[CAMERA DEBUG] Camera state changed from FOLLOWING_PLAYER to IDLE
✓ PASS: Immediate Movement: Camera should move to target immediately and emit signals
Signal received: camera_state_changed - 2
[CAMERA DEBUG] Camera state changed from IDLE to FOLLOWING_PLAYER
Running test: Animated Movement
ensure_valid_target called with position: (700, 500)
Current test_mode value: True
[TEST] Bypassing all bounds validation due to test_mode=true for: (700, 500)
move_to_position called with pos=(700, 500), immediate=False
Target position after validation: (700, 500)
Starting animated movement to (700, 500)
Signal received: camera_move_started - (700, 500)
Signal received: camera_state_changed - 1
[CAMERA DEBUG] Camera state changed from FOLLOWING_PLAYER to MOVING
[CAMERA DEBUG] Camera transition: Progress 0.083333, Position (536.53894, 399.141052), Target (700, 500)
[CAMERA DEBUG] Camera transition: Progress 0.166667, Position (578.845764, 425.24527), Target (700, 500)
[CAMERA DEBUG] Camera transition: Progress 0.25, Position (625.209473, 453.852661), Target (700, 500)
[CAMERA DEBUG] Camera transition: Progress 0.333333, Position (662.604736, 476.926331), Target (700, 500)
[CAMERA DEBUG] Camera transition: Progress 0.416667, Position (685.369507, 490.972687), Target (700, 500)
[CAMERA DEBUG] Camera transition: Progress 0.5, Position (695.714844, 497.355957), Target (700, 500)
[CAMERA DEBUG] Camera transition: Progress 0.583333, Position (699.114502, 499.453613), Target (700, 500)
[CAMERA DEBUG] Camera transition: Progress 0.666667, Position (699.881348, 499.926788), Target (700, 500)
Signal received: camera_move_completed - (700, 500)
Signal received: camera_state_changed - 2
[CAMERA DEBUG] Camera state changed from MOVING to FOLLOWING_PLAYER
[CAMERA DEBUG] Camera transition completed to (700, 500), took 0.116s
Signal received: camera_move_completed - (700, 500)
Signal received: camera_state_changed - 0
[CAMERA DEBUG] Camera state changed from FOLLOWING_PLAYER to IDLE
✓ PASS: Animated Movement: Camera should enter MOVING state for animated movement
Running test: Movement Progress
ensure_valid_target called with position: (700, 500)
Current test_mode value: True
[TEST] Bypassing all bounds validation due to test_mode=true for: (700, 500)
move_to_position called with pos=(700, 500), immediate=False
Target position after validation: (700, 500)
Starting animated movement to (700, 500)
Signal received: camera_move_started - (700, 500)
Signal received: camera_state_changed - 1
[CAMERA DEBUG] Camera state changed from IDLE to MOVING
[CAMERA DEBUG] Camera transition: Progress 0.083333, Position (536.53894, 399.141052), Target (700, 500)
[CAMERA DEBUG] Camera transition: Progress 0.166667, Position (578.845764, 425.24527), Target (700, 500)
[CAMERA DEBUG] Camera transition: Progress 0.25, Position (625.209473, 453.852661), Target (700, 500)
[CAMERA DEBUG] Camera transition: Progress 0.333333, Position (662.604736, 476.926331), Target (700, 500)
[CAMERA DEBUG] Camera transition: Progress 0.416667, Position (685.369507, 490.972687), Target (700, 500)
[CAMERA DEBUG] Camera transition: Progress 0.5, Position (695.714844, 497.355957), Target (700, 500)
[CAMERA DEBUG] Camera transition: Progress 0.583333, Position (699.114502, 499.453613), Target (700, 500)
[CAMERA DEBUG] Camera transition: Progress 0.666667, Position (699.881348, 499.926788), Target (700, 500)
Signal received: camera_move_completed - (700, 500)
Signal received: camera_state_changed - 2
[CAMERA DEBUG] Camera state changed from MOVING to FOLLOWING_PLAYER
[CAMERA DEBUG] Camera transition completed to (700, 500), took 0.115s
Signal received: camera_move_completed - (700, 500)
Signal received: camera_state_changed - 0
[CAMERA DEBUG] Camera state changed from FOLLOWING_PLAYER to IDLE
✓ PASS: Movement Progress: Movement progress should increase during animated movement
Suite completed: 1/1 tests passed
Signal received: camera_state_changed - 2
[CAMERA DEBUG] Camera state changed from IDLE to FOLLOWING_PLAYER
===== TEST SUITE: Signal Emission =====
Running test: State Change Signal
Signal received: camera_move_completed - (512, 384)
Signal received: camera_state_changed - 0
[CAMERA DEBUG] Camera state changed from FOLLOWING_PLAYER to IDLE
Signal received: camera_state_changed - 2
[CAMERA DEBUG] Camera state changed from IDLE to FOLLOWING_PLAYER
Signal received: camera_move_completed - (512, 384)
Signal received: camera_state_changed - 0
[CAMERA DEBUG] Camera state changed from FOLLOWING_PLAYER to IDLE
✓ PASS: State Change Signal: Camera should emit state_changed signal with correct parameters
Signal received: camera_state_changed - 2
[CAMERA DEBUG] Camera state changed from IDLE to FOLLOWING_PLAYER
Running test: Move Started Signal
Signal received: camera_move_completed - (512, 384)
Signal received: camera_state_changed - 0
[CAMERA DEBUG] Camera state changed from FOLLOWING_PLAYER to IDLE
Signal received: camera_move_started - (700, 500)
Signal received: camera_state_changed - 1
[CAMERA DEBUG] Camera state changed from IDLE to MOVING
Signal received: camera_move_completed - (512, 384)
Signal received: camera_state_changed - 0
[CAMERA DEBUG] Camera state changed from MOVING to IDLE
✓ PASS: Move Started Signal: Camera should emit move_started signal with correct parameters
Signal received: camera_state_changed - 2
[CAMERA DEBUG] Camera state changed from IDLE to FOLLOWING_PLAYER
Running test: Move Completed Signal
Signal received: camera_move_completed - (512, 384)
Signal received: camera_state_changed - 0
[CAMERA DEBUG] Camera state changed from FOLLOWING_PLAYER to IDLE
ensure_valid_target called with position: (700, 500)
Current test_mode value: True
[TEST] Bypassing all bounds validation due to test_mode=true for: (700, 500)
move_to_position called with pos=(700, 500), immediate=True
Target position after validation: (700, 500)
Immediate move from (512, 384) to (700, 500)
Signal received: camera_move_started - (700, 500)
Signal received: camera_move_completed - (700, 500)
✓ PASS: Move Completed Signal: Camera should emit move_completed signal
Signal received: camera_state_changed - 2
[CAMERA DEBUG] Camera state changed from IDLE to FOLLOWING_PLAYER
Suite completed: 2/2 tests passed
All tests completed.

===== TEST RESULTS =====
Total Tests: 15
Passed: 15
Failed: 0

All tests passed! 🎉
